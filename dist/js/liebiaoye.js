"use strict";$(function(){var r=0,s=document.querySelector(".liebiaoright-m ul"),o=document.querySelector(".liebiaoright-b b"),a=$("#lunbo div").css("width"),t=a.split("p")[0],e=getid("lunbo"),i=(document.querySelectorAll("#jiaodian span"),t=a.split("p")[0],0);function n(){clearInterval($timer),$timer=setInterval(function(){3<=++i&&(i=0),startMove(e,{left:-i*t}),$("#jiaodian span").eq(i).addClass("act"),$("#jiaodian span").eq(i).siblings().removeClass("act")},2e3)}function p(a,t){for(var e="",i=0;i<a;i++)e+="<li data-id = "+t[i].id+'>\n                    <img class="imgurl" src="../images/'+t[i].urlimg+'" alt="图片出错啦！">\n                    <a href="#" class=biaoti>'+t[i].title+'</a>\n                    <div>￥<span class="div-price">'+t[i].price+"</span></div>\n                    <p>已有"+t[i].pingjia+'人评价</p>\n                    <span>\n                        <a href="#" onclick = "return false" class="jiaru">加入购物车</a>\n                        <a href="#" class="guanzhu">关注</a>\n                    </span>\n                </li>';s.innerHTML=e}$timer=null,n(),$("#lunboBox").hover(function(){clearInterval($timer)},function(){n()}),$("#jiaodian span").click(function(){$(this).addClass("act"),$(this).siblings().removeClass("act"),startMove(e,{left:-$(this).index()*t})}),$.ajax({url:"../api/getdata.php",type:"get",data:{page:"1",qty:"8"},success:function(a){!function(a){var t=JSON.parse(a).total,e=JSON.parse(a).qty,i=Math.ceil(t/e),s=JSON.parse(a).datalist,n=s.length;o.innerHTML="共"+t+"条记录",p(n,s);for(var l="",c=1;c<=i;c++)l+='<a href="#" onclick="return false">'+c+"</a>";$(".pages").html(l),$(".liebiaoright-b a").eq(0).addClass("selected"),$(".liebiaoright-b a").click(function(){$(this).addClass("selected"),$(this).siblings().removeClass("selected"),r=$(this).text()-1,$.ajax({url:"../api/getdata.php",type:"get",data:{page:$(this).text(),qty:"8"},success:function(a){var t=JSON.parse(a).datalist,e=t.length;p(e,t)}})})}(a)}}),$(".prev").click(function(){3==r&&(r=2),--r<0?r=0:$.ajax({url:"../api/getdata.php",type:"get",data:{page:r+1,qty:"8"},success:function(a){var t=JSON.parse(a).datalist;p(t.length,t)}}),$(".pages a").eq(r).siblings().removeClass("selected"),$(".pages a").eq(r).addClass("selected")}),$(".next").click(function(){0==r&&(r=1),3<++r?r=3:$.ajax({url:"../api/getdata.php",type:"get",data:{page:r,qty:"8"},success:function(a){var t=JSON.parse(a).datalist;p(t.length,t)}}),$(".pages a").eq(r-1).siblings().removeClass("selected"),$(".pages a").eq(r-1).addClass("selected")}),$(".liebiaoright-m ul").on("click","img",function(){var a=this.parentNode.dataset.id;window.open("xiangqingye.html?id="+a)}),$(".liebiaoright-t li").click(function(){$(this).siblings().removeClass("paixu-act"),$(this).addClass("paixu-act")}),$(".paixu").click(function(){console.log(r),$.ajax({url:"../api/priceSort.php",type:"get",data:{page:r+1,qty:"8",sort:"0"},success:function(a){var t=JSON.parse(a);p(t.length,t)}})}),$(".liebiaoright-m").on("click",".jiaru",function(){var a=$(this).parent().parent().attr("data-id"),t=$(".imgurl").attr("src"),e=$(".biaoti").eq($(this).index()).text(),i=$(".div-price").eq($(this).index()).text();$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"add",id:a,title:e,price:i,img:t,num:1},success:function(a){"yes"==a.trim()?alert("加入购物车成功！"):alert("加入购物车失败！")}})}),$(".mycart").click(function(){window.open("ShopCart.html")})});