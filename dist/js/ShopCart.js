"use strict";$(function(){$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"select"},success:function(e){!function(e){for(var t=JSON.parse(e),c=t.length,a="",i=0;i<c;i++)a+='<li data-id = "'+t[i].id+'">\n            <div class="check">\n                <input type="checkbox" class="checked">\n            </div>\n            <div class="img-title">\n                <div class="img">\n                    <img src="'+t[i].urlimg+'" alt="图片出错啦">\n                </div>\n                <div class="title">'+t[i].title+'</div>\n            </div>\n            <div class="kong"></div>\n            <div class="prices">￥<span>'+t[i].price+'</span></div>\n            <div class="TheNum">\n                <span class="down">－</span>\n                <input type="text" class="num" value="'+t[i].num+'">\n                <span class="up">＋</span>\n            </div>\n            <div class="xiaoji">￥'+t[i].price+'</div>\n            <div class="del"><span class="delspan">删除</span></div>\n        </li>';$(".ul1").html(a),0<$(".ul1 li").size()?$(".AllNum").css("display","block"):$(".AllNum").css("display","none");$(".shopCart-t span").html($(".ul1 li").size())}(e)}}),$(".ul1").on("click",".up",function(){var e=$(this).prev().attr("value"),t=$(this).parent().parent().attr("data-id");10<++e?e=10:$(this).prev().attr("value",e),$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"updata",id:t,num:e}});var c=i();a(c),n(c)}),$(".ul1").on("click",".down",function(){var e=$(this).next().attr("value"),t=$(this).parent().parent().attr("data-id");--e<1?e=1:$(this).next().attr("value",e),$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"updata",id:t,num:e}});var c=i();a(c),n(c)}),$(".ul1").on("click",".up",function(){var e=($(this).parent().prev().text().slice(1)*$(this).prev().val()).toFixed(2);$(this).parent().next().html("￥"+e)}),$(".ul1").on("click",".down",function(){var e=($(this).parent().prev().text().slice(1)*$(this).next().val()).toFixed(2);$(this).parent().next().html("￥"+e)}),$(".ul1").on("click",".checked",function(){$(".xiaoji").eq(1).text().slice(1);var e=i(),t=e.length;$(".ul1 li").size()==t?($(".selectAll input").prop("checked","checked"),$(".left1 input").prop("checked","checked")):($(".selectAll input").removeAttr("checked"),$(".left1 input").removeAttr("checked")),a(e),l(),n(e)});var t=!0;function i(){for(var e=[],t=$(".check input").size(),c=0;c<t;c++)$(".checked").eq(c).prop("checked")&&e.push(c);return e}function a(e){for(var t=0,c=0;c<e.length;c++)t+=1*$(".num").eq(e[c]).val();$(".haveSelect span").html(t)}function n(e){for(var t=0,c=0;c<e.length;c++){t+=1*$(".xiaoji").eq(e[c]).text().slice(1)}$(".count span").html("￥"+t)}function l(){0<i().length?$(".pay").addClass("gopay"):$(".pay").removeClass("gopay")}function p(){0==$(".ul1 li").size()&&$(".AllNum").remove()}$(".selectAll-sp").click(function(){t?($(".selectAll input").prop("checked","checked"),$(".check input").prop("checked","checked"),$(".left1 input").prop("checked","checked")):($(".selectAll input").removeAttr("checked"),$(".check input").removeAttr("checked"),$(".left1 input").removeAttr("checked")),t=!t,l();var e=i();a(e),n(e)}),$(".left1 input").click(function(){t?($(".left1 input").prop("checked","checked"),$(".selectAll input").prop("checked","checked"),$(".check input").prop("checked","checked")):($(".selectAll input").removeAttr("checked"),$(".selectAll input").removeAttr("checked"),$(".check input").removeAttr("checked")),t=!t,l();var e=i();a(e),n(e)}),$(".ul1").on("click",".delspan",function(){var e=$(this).parent().parent().attr("data-id"),t=$(this).parent().parent();confirm("您确定要删除该商品吗？")&&$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"del",id:e},success:function(e){"yes"==e.trim()?t.remove():alert("哎哟~删除失败了")}});var c=i();a(c),l(),n(c),p()}),$(".left2").click(function(){var t=i(),e=t.length;if(0==e)alert("您还没选择任何商品呢");else if(confirm("您确定要删除商品吗？"))for(var c=e;0<=c;c--){var a=$(".ul1 li").eq(t[c]).attr("data-id");$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"del",id:a},success:function(e){"yes"==e.trim()?$(".ul1 li").eq(t[c]).remove():alert("哎哟~删除失败了"),p()}})}}),$(".left3").click(function(){confirm("您确定要清空购物车吗？")&&$.ajax({url:"../api/ShopCart.php",type:"get",data:{can:"delectAll"},success:function(e){"yes"==e.trim()?$(".ul1 li").remove():alert("哎哟~删除失败了")}}),p()})});